<header class="header">
  <div class="left">
    <h2 class="logo">Task Manager</h2>
  </div>

  <div class="right" *ngIf="currentUser$ | async as user">
    <!-- ðŸ”” Notification Bell -->
    <button mat-icon-button [matMenuTriggerFor]="notifMenu" class="notif-btn">
      <mat-icon>notifications</mat-icon>
      <span *ngIf="unreadCount > 0" class="badge">{{ unreadCount }}</span>
    </button>

    <mat-menu #notifMenu="matMenu" class="notif-menu">
      <h4 class="notif-title">Notifications</h4>
      <button mat-menu-item *ngIf="notifications.length === 0">
        No notifications
      </button>

      <button
        mat-menu-item
        *ngFor="let n of notifications; let i = index"
      >
        <mat-icon color="primary">task_alt</mat-icon>
        <span>{{ n?.message || n?.title }}</span>
      </button>

      <button mat-menu-item (click)="markAllRead()">
        <mat-icon>done_all</mat-icon>
        Mark all read
      </button>
    </mat-menu>

    <!-- ðŸ§‘ User Avatar / Dropdown -->
    <button mat-button [matMenuTriggerFor]="userMenu">
      <mat-icon>account_circle</mat-icon>
      {{ user.email }}
    </button>

    <mat-menu #userMenu="matMenu">
      <button mat-menu-item routerLink="/profile">
        <mat-icon>person</mat-icon>
        Profile
      </button>

      <button mat-menu-item (click)="logout()">
        <mat-icon>logout</mat-icon>
        Logout
      </button>
    </mat-menu>
  </div>
</header>
